<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projektplaner</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1>ðŸ“‹ Projektplaner</h1>
    <p>Projektplanung zur besseren Organisation</p>
</header>

<!-- LOGIN -->
<section id="loginBox" class="form-section">
    <h2>Login</h2>

    <label>Benutzername</label>
    <input id="username" type="text">

    <label>Passwort</label>
    <input id="password" type="password">

    <button onclick="login()">Login</button>
</section>

<!-- APP -->
<div id="app" style="display:none;">

<section class="form-section">
    <h2>Projektinformationen</h2>

    <label>Projektname</label>
    <input id="projectName" type="text">

    <label>Projektbeschreibung</label>
    <textarea id="projectDesc" rows="4"></textarea>

    <div class="grid-2">
        <div>
            <label>Startdatum</label>
            <input id="startDate" type="date">
        </div>
        <div>
            <label>Enddatum</label>
            <input id="endDate" type="date">
        </div>
    </div>
</section>

<section class="form-section">
    <h2>Meilensteine</h2>
    <table>
        <tr>
            <th>Meilenstein</th>
            <th>FÃ¤lligkeitsdatum</th>
            <th>Status</th>
        </tr>
        <tr>
            <td contenteditable="true">MVP</td>
            <td><input type="date"></td>
            <td contenteditable="true">In Planung</td>
        </tr>
        <tr>
            <td contenteditable="true">Release 1.0</td>
            <td><input type="date"></td>
            <td contenteditable="true">Offen</td>
        </tr>
    </table>
</section>

<section class="form-section">
    <h2>Kanban Board</h2>

    <div class="kanban">
        <div class="col">
            <h3>To Do</h3>
            <input id="newTask" placeholder="Neue Aufgabe erstellen"
                onkeydown="if(event.key==='Enter'){addTask()}">
            <div class="kanban-box" id="todo"
                ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        </div>

        <div class="col">
            <h3>In Progress</h3>
            <h3></h3>
            <div class="kanban-box" id="progress"
                ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        </div>

        <div class="col">
            <h3>Review</h3>
            <div class="kanban-box" id="review"
                ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        </div>

        <div class="col">
            <h3>Done</h3>
            <div class="kanban-box" id="done"
                ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        </div>
    </div>

    <button onclick="logout()">Logout</button>
</section>

</div>

<footer>
    <p>Â© 2025 Projektplaner â€¢ HTML, CSS & JavaScript â€¢ LocalStorage</p>
</footer>

<script>
let currentUser = null;
let taskId = 0;

/* LOGIN */
function login() {
    const u = username.value.trim();
    const p = password.value;
    if (!u || !p) return alert("Bitte alles ausfÃ¼llen");

    const users = JSON.parse(localStorage.getItem("users") || "{}");

    if (!users[u]) users[u] = { password: p, data: {} };
    if (users[u].password !== p) return alert("Falsches Passwort");

    currentUser = u;
    localStorage.setItem("currentUser", u);

    loginBox.style.display = "none";
    app.style.display = "block";
    loadAll();
}

function logout() {
    localStorage.removeItem("currentUser");
    location.reload();
}

/* KANBAN */
function addTask() {
    const text = newTask.value.trim();
    if (!text) return;

    const t = document.createElement("div");
    t.className = "task";
    t.textContent = text;
    t.draggable = true;
    t.id = "task-" + taskId++;
    t.ondragstart = drag;

    todo.appendChild(t);
    newTask.value = "";
    saveAll();
}

function allowDrop(e) { e.preventDefault(); }
function drag(e) { e.dataTransfer.setData("id", e.target.id); }
function drop(e) {
    e.preventDefault();
    const id = e.dataTransfer.getData("id");
    e.target.appendChild(document.getElementById(id));
    saveAll();
}

/* STORAGE */
function saveAll() {
    const users = JSON.parse(localStorage.getItem("users"));
    users[currentUser].data = {
        projectName: projectName.value,
        projectDesc: projectDesc.value,
        startDate: startDate.value,
        endDate: endDate.value,
        todo: todo.innerHTML,
        progress: progress.innerHTML,
        review: review.innerHTML,
        done: done.innerHTML
    };
    localStorage.setItem("users", JSON.stringify(users));
}

function loadAll() {
    const u = JSON.parse(localStorage.getItem("users"))[currentUser].data || {};
    projectName.value = u.projectName || "";
    projectDesc.value = u.projectDesc || "";
    startDate.value = u.startDate || "";
    endDate.value = u.endDate || "";
    todo.innerHTML = u.todo || "";
    progress.innerHTML = u.progress || "";
    review.innerHTML = u.review || "";
    done.innerHTML = u.done || "";

    document.querySelectorAll(".task").forEach(t => t.ondragstart = drag);
}

/* AUTO LOGIN */
window.onload = () => {
    const u = localStorage.getItem("currentUser");
    if (u) {
        currentUser = u;
        loginBox.style.display = "none";
        app.style.display = "block";
        loadAll();
    }
};
</script>

</body>
</html>
/* hallo */